/*! For license information please see chunk-5a27a2b14e5bb15abebc.js.LICENSE.txt */
"use strict";(self.webpackChunkai_tab_manager=self.webpackChunkai_tab_manager||[]).push([[832],{8531:(e,n,t)=>{t.r(n),t.d(n,{Tokenizer:()=>l,UniversalSentenceEncoder:()=>w,load:()=>y,loadQnA:()=>b,loadTokenizer:()=>h,version:()=>d});var r=t(5718),o=t(8355);function i(e,n,t,r){return new(t||(t=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function u(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(s,u)}c((r=r.apply(e,n||[])).next())}))}function s(e,n){var t,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;s;)try{if(t=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=n.call(e,s)}catch(e){i=[6,e],r=0}finally{t=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}}var u=function(e){for(var n=[],t=0,r=e;t<r.length;t++){var o=r[t];n.push(o)}return n},c=function(){this.parent=null,this.children={},this.end=!1,this.word=[[],0,0]},a=function(){function e(){this.root=new c}return e.prototype.insert=function(e,n,t){for(var r=this.root,o=u(e),i=0;i<o.length;i++)r.children[o[i]]||(r.children[o[i]]=new c,r.children[o[i]].parent=r,r.children[o[i]].word[0]=r.word[0].concat(o[i])),r=r.children[o[i]],i===o.length-1&&(r.end=!0,r.word[1]=n,r.word[2]=t)},e.prototype.commonPrefixSearch=function(e){for(var n=[],t=this.root.children[e[0]],r=0;r<e.length&&t;r++)t.end&&n.push(t.word),t=t.children[e[r+1]];return n.length||n.push([[e[0]],0,0]),n},e}(),l=function(){function e(e,n){void 0===n&&(n=6),this.vocabulary=e,this.reservedSymbolsCount=n,this.trie=new a;for(var t=this.reservedSymbolsCount;t<this.vocabulary.length;t++)this.trie.insert(this.vocabulary[t][0],this.vocabulary[t][1],t)}return e.prototype.encode=function(e){var n=[],t=[],r=[];e=function(e){var n=e.normalize("NFKC");return n.length>0?"▁"+n.replace(/ /g,"▁"):n}(e);for(var o=u(e),i=0;i<=o.length;i++)n.push({}),t.push(0),r.push(0);for(i=0;i<o.length;i++)for(var s=this.trie.commonPrefixSearch(o.slice(i)),c=0;c<s.length;c++){var a=s[c],l={key:a[0],score:a[1],index:a[2]};null==n[i+(h=a[0].length)][i]&&(n[i+h][i]=[]),n[i+h][i].push(l)}for(var h=0;h<=o.length;h++)for(var f in n[h]){var d=n[h][f];for(c=0;c<d.length;c++){var v=d[c],p=v.score+r[h-v.key.length];(0===r[h]||p>=r[h])&&(r[h]=p,t[h]=d[c].index)}}for(var g=[],b=t.length-1;b>0;)g.push(t[b]),b-=this.vocabulary[t[b]][0].length;var m=[],y=!1;for(i=0;i<g.length;i++){var w=g[i];y&&0===w||m.push(w),y=0===w}return m.reverse()},e}();function h(e){return i(this,void 0,void 0,(function(){var n;return s(this,(function(t){switch(t.label){case 0:return[4,f(e)];case 1:return n=t.sent(),[2,new l(n)]}}))}))}function f(e){return i(this,void 0,void 0,(function(){return s(this,(function(n){switch(n.label){case 0:return[4,r.ZSL.fetch(e)];case 1:return[2,n.sent().json()]}}))}))}var d="1.3.3",v="https://tfhub.dev/google/tfjs-model/universal-sentence-encoder-qa-ondevice/1",p=[0,1,2],g=192;function b(){return i(this,void 0,void 0,(function(){var e;return s(this,(function(n){switch(n.label){case 0:return[4,(e=new m).load()];case 1:return n.sent(),[2,e]}}))}))}var m=function(){function e(){}return e.prototype.loadModel=function(){return i(this,void 0,void 0,(function(){return s(this,(function(e){return[2,(0,o.ox)(v,{fromTFHub:!0})]}))}))},e.prototype.load=function(){return i(this,void 0,void 0,(function(){var e,n,t;return s(this,(function(r){switch(r.label){case 0:return[4,Promise.all([this.loadModel(),f(v+"/vocab.json?tfjs-format=file")])];case 1:return e=r.sent(),n=e[0],t=e[1],this.model=n,this.tokenizer=new l(t,3),[2]}}))}))},e.prototype.embed=function(e){var n=this,t=(0,r.DZQ)((function(){var t=n.tokenizeStrings(e.queries,g),r=n.tokenizeStrings(e.responses,g);if(null!=e.contexts&&e.contexts.length!==e.responses.length)throw new Error("The length of response strings and context strings need to match.");var o=e.contexts||[];null==e.contexts&&(o.length=e.responses.length,o.fill(""));var i=n.tokenizeStrings(o,g),s={};return s.input_inp_text=t,s.input_res_text=r,s.input_res_context=i,n.model.execute(s,["Final/EncodeQuery/mul","Final/EncodeResult/mul"])}));return{queryEmbedding:t[0],responseEmbedding:t[1]}},e.prototype.tokenizeStrings=function(e,n){var t=this,o=e.map((function(e){return t.shiftTokens(t.tokenizer.encode(e),g)}));return(0,r.KtR)(o,[e.length,g],"int32")},e.prototype.shiftTokens=function(e,n){e.unshift(1);for(var t=0;t<n;t++)t>=e.length?e[t]=2:p.includes(e[t])||(e[t]+=3);return e.slice(0,n)},e}();function y(e){return i(this,void 0,void 0,(function(){var n;return s(this,(function(t){switch(t.label){case 0:return[4,(n=new w).load(e)];case 1:return t.sent(),[2,n]}}))}))}var w=function(){function e(){}return e.prototype.loadModel=function(e){return i(this,void 0,void 0,(function(){return s(this,(function(n){return[2,e?(0,o.ox)(e):(0,o.ox)("https://tfhub.dev/tensorflow/tfjs-model/universal-sentence-encoder-lite/1/default/1",{fromTFHub:!0})]}))}))},e.prototype.load=function(e){return void 0===e&&(e={}),i(this,void 0,void 0,(function(){var n,t,r;return s(this,(function(o){switch(o.label){case 0:return[4,Promise.all([this.loadModel(e.modelUrl),f(e.vocabUrl||"https://storage.googleapis.com/tfjs-models/savedmodel/universal_sentence_encoder/vocab.json")])];case 1:return n=o.sent(),t=n[0],r=n[1],this.model=t,this.tokenizer=new l(r),[2]}}))}))},e.prototype.embed=function(e){return i(this,void 0,void 0,(function(){var n,t,o,i,u,c,a,l,h=this;return s(this,(function(s){switch(s.label){case 0:for("string"==typeof e&&(e=[e]),n=e.map((function(e){return h.tokenizer.encode(e)})),t=n.map((function(e,n){return e.map((function(e,t){return[n,t]}))})),o=[],i=0;i<t.length;i++)o=o.concat(t[i]);return u=(0,r.KtR)(o,[o.length,2],"int32"),c=(0,r.tGX)(r.ZSL.flatten(n),"int32"),a={indices:u,values:c},[4,this.model.executeAsync(a)];case 1:return l=s.sent(),u.dispose(),c.dispose(),[2,l]}}))}))},e}()}}]);
//# sourceMappingURL=chunk-5a27a2b14e5bb15abebc.js.map